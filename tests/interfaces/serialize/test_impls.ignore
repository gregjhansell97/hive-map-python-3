#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
"""

from collections import defaultdict
import math
import pytest


def test_serialize_deserialize(Impl):
    instances, eq = Impl()
    # try all argsuments
    for instance in instances:
        Cls = type(instance)
        raw_bytes = Cls.serialize(instance)
        others = [i for i in instances if i is not instance]
        for i in range(10):
            raw_bytes += raw_bytes + b"more data"
            assert eq(Cls.deserialize(raw_bytes), instance)
            instance = Cls.deserialize(raw_bytes)
        # make sure it doesn't match other instances when serialized
        for other in others:
            assert not eq(other, instance)

def _test_lazy_serialize_deserialize():
    #TODO
    pass

def _test_multi_threaded_serialize_deserialize():
    #TODO
    pass

def _test_multi_threaded_lazy_serialize_deserialize():
    #TODO
    pass
